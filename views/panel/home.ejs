
<section class="section-home-main-center">
    <section class="home-section-card-background" id="home-section-card-background">
        <!--  -->
    </section>

    <!-- -->
    
    <section class="home-body-page">
        <section class="section-box-suspended">
            <div class="suspended-title">
                <div class="title-page-info">
                    <span>Olá <%= GLOBAL_DASH[8] %></span>
                    <span>Você possui <label id="count-notify">0</label> notificação(ões)</span>
                </div>
            </div>
            <div class="suspended-main">
                <% if(GLOBAL_PERM[0].sys_cal_perm_use == 1){ %>
                <div class="suspended-blocks-container">
                    <div class="suspended-container-center">
                        <div class="suspended-title">
                            <span>Calendario</span>
                        </div>
                        <div class="home-main-suspended-box">
                            <div class="main-suspended-info">
                                <a class="main-suspended-group-info class-loader" href="/painel/calendario/main/">
                                    <div class="sys-icon-def">
                                        <img class="sys-icon-size" src="/icons/icon-calendar.png" alt="">
                                    </div>
                                    <span>⠀</span>
                                    <span><b><%= CALENDARcount %></b>⠀participação(ões) <i class="ri-external-link-line"></i></span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <% } %>


                <% if(GLOBAL_PERM[0].sys_req_perm_use == 1){ %>
                <div class="suspended-blocks-container">
                    <div class="suspended-container-center">
                        <div class="suspended-title">
                            <span>Requisitor de Materiais</span>
                        </div>
                        <% if (REQUISITORstatus == true){ %>
                            <div class="home-main-suspended-box">
                                <div class="main-suspended-info">
                                    <a class="main-suspended-group-info class-loader" href="/painel/requisitor/MinhasRequisicoes">
                                        <div class="sys-icon-def">
                                            <img class="sys-icon-size" src="/icons/icon-requisitor.png" alt="">
                                        </div>
                                        <span>⠀</span>
                                        <span>Você possui requisições <i class="ri-external-link-line"></i></span>
                                    </a>
                                </div>
                            </div>
                        <% }else{ %>
                            <div class="home-main-suspended-box">
                                <div class="main-suspended-info">
                                    <a class="main-suspended-group-info class-loader" href="/painel/requisitor/Novo">
                                        <div class="sys-icon-def">
                                            <img class="sys-icon-size" src="/icons/icon-requisitor.png" alt="">
                                        </div>
                                        <span>⠀</span>
                                        <span>Faça sua requisição <i class="ri-external-link-line"></i></span>
                                    </a>
                                </div>
                            </div>
                        <% } %>
                    </div>
                </div>
                <% } %>


                <% if(GLOBAL_PERM[0].sys_blz_perm_use == 1){ %>
                <div class="suspended-blocks-container">
                    <div class="suspended-container-center">
                        <div class="suspended-title">
                            <span>Progama da Beleza</span>
                        </div>
                        <% if(system_blz_status == 2){ %>
                            <div class="home-main-suspended-box">
                                <div class="main-suspended-info">
                                    <a class="main-suspended-group-info class-loader" href="/painel/beleza/status">
                                        <div class="sys-icon-def">
                                            <img class="sys-icon-size" src="/icons/icon-progama-da-beleza.png" alt="">
                                        </div>
                                        <span>⠀</span>
                                        <span>Solicitação concluída <i class="ri-external-link-line"></i></span>
                                    </a>
                                </div>
                            </div>
                        <% }else if(system_blz_status == 1){ %>
                            <div class="home-main-suspended-box">
                                <div class="main-suspended-info">
                                    <a class="main-suspended-group-info class-loader" href="/painel/beleza/solicitar">
                                        <div class="sys-icon-def">
                                            <img class="sys-icon-size" src="/icons/icon-progama-da-beleza.png" alt="">
                                        </div>
                                        <span>⠀</span>
                                        <span>Solicitação pendente <i class="ri-external-link-line"></i></span>
                                    </a>
                                </div>
                            </div>
                        <% }else if(system_blz_status == 3){ %>
                            <div class="home-main-suspended-box">
                                <div class="main-suspended-info">
                                    <a class="main-suspended-group-info class-loader" href="/painel/beleza/solicitar">
                                        <div class="sys-icon-def">
                                            <img class="sys-icon-size" src="/icons/icon-progama-da-beleza.png" alt="">
                                        </div>
                                        <span>⠀</span>
                                        <span>Solicitação cancelada <i class="ri-external-link-line"></i></span>
                                    </a>
                                </div>
                            </div>
                        <% }else if(system_blz_status == 4){ %>
                            <div class="home-main-suspended-box">
                                <div class="main-suspended-info">
                                    <a class="main-suspended-group-info class-loader" href="/painel/beleza/status">
                                        <div class="sys-icon-def">
                                            <img class="sys-icon-size" src="/icons/icon-progama-da-beleza.png" alt="">
                                        </div>
                                        <span>⠀</span>
                                        <span>Solicitação separada <i class="ri-external-link-line"></i></span>
                                    </a>
                                </div>
                            </div>
                        <% }else if(system_blz_status == 5){ %>
                            <div class="home-main-suspended-box">
                                <div class="main-suspended-info">
                                    <a class="main-suspended-group-info class-loader" href="/painel/beleza/status">
                                        <div class="sys-icon-def">
                                            <img class="sys-icon-size" src="/icons/icon-progama-da-beleza.png" alt="">
                                        </div>
                                        <span>⠀</span>
                                        <span>Pedido de cancelamento <i class="ri-external-link-line"></i></span>
                                    </a>
                                </div>
                            </div>
                        <% }else if(system_blz_status == false){ %>
                            <div class="home-main-suspended-box">
                                <div class="main-suspended-info">
                                    <a class="main-suspended-group-info class-loader" href="/painel/beleza/solicitar">
                                        <div class="sys-icon-def">
                                            <img class="sys-icon-size" src="/icons/icon-progama-da-beleza.png" alt="">
                                        </div>
                                        <span>⠀</span>
                                        <span>Solicitação Pendente <i class="ri-external-link-line"></i></span>
                                    </a>
                                </div>
                            </div>
                        <% } %>
                    </div>
                </div>
                <% } %>

                <% if(GLOBAL_PERM[0].sys_tra_perm_use == 1 || GLOBAL_PERM[0].sys_tra_perm_admin == 1){ %>
                    <div class="suspended-blocks-container">
                        <div class="suspended-container-center">
                            <div class="suspended-title">
                                <span>Trade MKT</span>
                            </div>
                            
                            <div class="home-main-suspended-box">
                                <div class="main-suspended-info">
                                    <a class="main-suspended-group-info class-loader" href="/painel/trademkt/main">
                                        <div class="sys-icon-def">
                                            <img class="sys-icon-size" src="/icons/icon-trade.png" alt="">
                                        </div>
                                        <span>⠀</span>
                                        <span><b><%= TRADEMKTcount %></b>⠀formulário para responder <i class="ri-external-link-line"></i></span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                <% } %>

                <% if(GLOBAL_PERM[0].sys_blz_perm_manager == 1){ %>
                <div class="home-logs-system" style="width: <%= GLOBAL_PERM[0].sys_cal_perm_admin == 1 ? '48%' : '100%' %>;">
                    <div class="home-logs-main">
                        <div class="home-logs-title"><span>Programa da Beleza</div>
                        <div class="home-logs-list-chars">
                            <canvas id="grapichs-main-display-beleza" width="100%" height="100%"></canvas>
                        </div>
                    </div>
                </div>
                <% } %>

                <% if(GLOBAL_PERM[0].sys_cal_perm_admin == 1){ %>
                <div class="home-logs-system">
                    <div class="home-logs-main">
                        <div class="home-logs-title"><span>Calendário</span></div>
                        <div class="home-logs-list-chars">
                            <canvas id="grapichs-main-display-calendar" width="100%" height="100%"></canvas>
                        </div>
                    </div>
                </div>
                <% } %>
            </div>
        </section>

        <!-- -->

    </section>
</section>
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
<script>

    let arrayConvert = JSON.parse('<%- arrayConvert %>')
    let monthReference = arrayConvert['dateBeleza'].split('-')[0]+'/'+arrayConvert['dateBeleza'].split('-')[1]
    delete arrayConvert['dateBeleza']

    const ctx = document.getElementById('grapichs-main-display-beleza').getContext('2d');
    const myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: Object.keys(arrayConvert),
            datasets: [{
                label: ' Mais pedido',
                data: Object.values(arrayConvert),
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(255, 159, 64, 0.2)'
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            },
                plugins: {
                title: {
                    display: true,
                    text: 'Produtos mais solicitados '+monthReference
                }
            }
        }
    });

    let arrayConvertBox = JSON.parse('<%- arrayCalendar %>')
    let monthReferenceBox = arrayConvertBox['dateCalendar']
    delete arrayConvertBox['dateCalendar']

    let objValues = Object.values(arrayConvertBox).map(convertSetVal);
    function convertSetVal(value){
        return value[1]
    }

    let objRooms = Object.keys(arrayConvertBox).map(convertSetRooms);
    function convertSetRooms(value){
        return value
    }

    let colorsValues = Object.values(arrayConvertBox).map(convertSetColos);
    function convertSetColos(value){
        return value[0]
    }
    
    const boxctx = document.getElementById('grapichs-main-display-calendar').getContext('2d');
    const myChartBox = new Chart(boxctx, {
        type: 'bar',
        data: {
            labels: objRooms,
            datasets: [{
                label: ' Sala mais utilizada',
                data: objValues,
                backgroundColor: 'transparent',
                borderColor: colorsValues,
                borderWidth: 1,
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            },
                plugins: {
                title: {
                    display: true,
                    text: 'Sala mais utilizada '+monthReferenceBox
                }
            }
        }
    });
</script>